<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Store</title>
<style>
body { margin:0; font-family:'Segoe UI'; background:#f4f6f9; }
header { background:white; padding:15px 40px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 2px 10px rgba(0,0,0,0.05);}
.container { padding:40px; }
.grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:25px; }
.card { background:white; border-radius:12px; padding:20px; box-shadow:0 4px 15px rgba(0,0,0,0.05);}
button { padding:10px; background:black; color:white; border:none; cursor:pointer; }
</style>
</head>
<body>

<header>
<h2>âš¡ MyStore</h2>
<a href="cart.html">ðŸ›’ Cart (<span id="cartCount">0</span>)</a>
</header>

<div class="container">
<div class="grid" id="products"></div>
</div>

<script>

const API="/products";

function updateCartCount(){
    const cart=JSON.parse(localStorage.getItem("cart"))||[];
    document.getElementById("cartCount").innerText=
        cart.reduce((sum,i)=>sum+i.qty,0);
}

async function loadProducts(){
    const res=await fetch(API);
    const products=await res.json();
    const container=document.getElementById("products");
    container.innerHTML="";

    products.forEach(p=>{
        container.innerHTML+=`
        <div class="card">
            <h3>${p.name}</h3>
            <p>${p.description||""}</p>
            <p><b>â‚¹${p.price}</b></p>
            <p>Stock: ${p.availableQuantity}</p>
            <button onclick="addToCart('${p.id}', '${p.name}', ${p.price})">
                Add to Cart
            </button>
        </div>`;
    });
}

function addToCart(id,name,price){
    let cart=JSON.parse(localStorage.getItem("cart"))||[];
    const existing=cart.find(i=>i.productId===id);
    if(existing) existing.qty++;
    else cart.push({productId:id,name,price,qty:1});
    localStorage.setItem("cart",JSON.stringify(cart));
    updateCartCount();
}

updateCartCount();
loadProducts();

</script>

</body>
</html>
